Finish refactoring custom render funcs
DRY up some more of the copied JS